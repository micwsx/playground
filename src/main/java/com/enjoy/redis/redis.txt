
redis分布式锁基本三大保证：
 1.只能某个客户端独享（相互排斥）。在任意时刻只能有一个客户端持有锁。
 2.不能出现死锁。即使某客户端出现异常，锁仍然可以被获取（设置一个过期时间）
 3.容错。只要大部分redis结点存活，客户端可以获取和释放锁。
主从结构有明显的竞态：
1.客户端A从master获取锁。
2.master还没有同步到slave就宕机了。
3.slave此时升级为master.
4.B客户端此时获取同一个资源被客户端A已经获取到的另外一个锁。安全失效！


